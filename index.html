<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ° C9 1íšŒì°¨ ë‚­í”Œë‹¨</title>

<style>
/* ===== ì „ì²´ ===== */
body {
    background: #FFF6FA;
    font-family: "Pretendard", -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
    display: flex;
    justify-content: center;
    padding: 20px 16px;
    margin: 0;
    color: #4c2d3b;
}

.wrap {
    width: 100%;
    margin: 0 auto;
}

/* ===== ì œëª© ===== */
h1 {
    text-align: center;
    font-size: 22px;
    font-weight: 800;
    margin-bottom: 20px;
    color: #FF8FB2;
}

/* ===== ìŠ¤í¬ë¡¤ ===== */
.table-scroll {
    overflow-x: auto;
    padding-bottom: 6px;
}

/* ===== í…Œì´ë¸”(í–‰ ë¬¶ìŒ) ===== */
.table {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 720px; /* ìƒˆ ì—´ ì¶”ê°€ë¡œ ìµœì†Œí­ ì¦ê°€ */
}

/* ===== í–‰ ===== */
.row {
    display: flex;
    background: white;
    border-radius: 26px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(255,150,180,0.08);
    padding: 4px 0;
}

/* ===== ì…€ ===== */
.cell {
    padding: 8px 12px;
    font-size: 14px;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    border-right: 1px solid #FFE1EF;
    outline: none;
    cursor: text;
    white-space: nowrap;
}
.cell:last-child {
    border-right: none;
}

/* ===== í—¤ë” ===== */
.header {
    background: #FFEFF7;
}
.header .cell {
    font-weight: 700;
    color: #D04F7D;
    border-bottom: 2px solid #F8C7DB;
    contenteditable: false;
    cursor: default;
}

/* ===== ë²„íŠ¼ ì˜ì—­ (í–‰ ë§ˆì§€ë§‰ ì¹¸) ===== */
.action-cell {
    position: relative;
    width: 60px;
    cursor: default;
    border-right: none;
}

/* ë²„íŠ¼ ì»¨í…Œì´ë„ˆ - ê¸°ë³¸ ìˆ¨ê¹€ */
.action-buttons {
    display: none;
    gap: 6px;
    position: absolute;
    right: 6px;
    top: 50%;
    transform: translateY(-50%);
}

/* ë²„íŠ¼ ìŠ¤íƒ€ì¼ (Bí˜• ì•„ì´ì½˜ ìŠ¤íƒ€ì¼) */
.action-buttons button {
    background: #FFD8EA;
    border: none;
    border-radius: 10px;
    padding: 6px 10px;
    font-size: 12px;
    cursor: pointer;
    color: #D24E78;
}

/* í–‰ í´ë¦­ ì‹œ í‘œì‹œ */
.row.show-actions .action-buttons {
    display: flex;
}

/* ===== ìƒ‰ìƒ íŒ”ë ˆíŠ¸(ì—°í•œí•‘í¬) ===== */
:root {
    --lv0: #FFFFFF;
    --lv1: #FFF9FD;
    --lv2: #FFF3FA;
    --lv3: #FFE9F4;
    --lv4: #FFE0EF;
    --lv5: #FFD7EB;
    --lv6: #FFCEE7;
    --lv7: #FFC6E3;
    --lv8: #FFBEDF;
    --lv9: #FFB6DA;
}
</style>
</head>

<body>
<div class="wrap">

<h1>ğŸ° C9 1íšŒì°¨ ë‚­í”Œë‹¨</h1>

<div class="table-scroll">
    <div class="table" id="table">

        <!-- í—¤ë” -->
        <div class="row header">
            <div class="cell">ì•„ì´ë””</div>
            <div class="cell">ë‹‰ë„¤ì„</div>
            <div class="cell sort-btn" data-sort="amount">ê°¯ìˆ˜ â¬</div>
            <div class="cell">ì›í”Œì›</div>
            <div class="cell">ê³µì•½</div>
            <div class="cell">ì—­íŒ¬</div>
            <div class="cell">ë¹„ê³ </div>
            <div class="cell action-cell"></div>
        </div>

        <!-- ì˜ˆì‹œ ë°ì´í„° -->
        <div class="row data-row">
            <div class="cell" contenteditable="true">danggun</div>
            <div class="cell" contenteditable="true">ë‹¹êµ°</div>
            <div class="cell amount-cell" contenteditable="true">30000</div>
            <div class="cell" contenteditable="true">1</div>
            <div class="cell" contenteditable="true">ì¶œì„</div>
            <div class="cell ygp-cell" contenteditable="false"></div>
            <div class="cell" contenteditable="true">VIP</div>

            <div class="cell action-cell">
                <div class="action-buttons">
                    <button class="add">+</button>
                    <button class="del">ğŸ—‘</button>
                </div>
            </div>
        </div>

    </div>
</div>

</div>

<script>

/* ===========================
   1) ìƒ‰ìƒ & ì—­íŒ¬ ê³„ì‚°
=========================== */
function applyRowStyle(row){
    const amountCell = row.querySelector(".amount-cell");
    const ygpCell    = row.querySelector(".ygp-cell");
    if(!amountCell || !ygpCell) return;

    const num = parseInt(amountCell.innerText.replace(/[^0-9]/g,'')) || 0;
    ygpCell.innerText = num > 0 ? Math.round(num * 0.03) : "";

    let lv="--lv0";
    if(num >=100 && num<=298) lv="--lv1";
    else if(num<=999) lv="--lv2";
    else if(num<=2999) lv="--lv3";
    else if(num<=4999) lv="--lv4";
    else if(num<=9999) lv="--lv5";
    else if(num<=49999) lv="--lv6";
    else if(num<=99999) lv="--lv7";
    else if(num<=299999) lv="--lv8";
    else lv="--lv9";

    row.style.background = `var(${lv})`;
}

function refreshAll(){
    document.querySelectorAll(".data-row").forEach(applyRowStyle);
}


/* ===========================
   2) ì—´ ë„ˆë¹„ ë™ê¸°í™”
=========================== */
function syncColumnWidths(){
    const rows = [...document.querySelectorAll(".row")];
    if(rows.length < 2) return;

    const cols = rows[0].children.length;
    let widths = Array(cols).fill(0);

    rows.forEach(row=>{
        [...row.children].forEach((cell,i)=>{
            widths[i] = Math.max(widths[i], cell.scrollWidth);
        });
    });

    rows.forEach(row=>{
        [...row.children].forEach((cell,i)=>{
            cell.style.width = widths[i] + "px";
        });
    });
}


/* ===========================
   3) í–‰ í´ë¦­ â†’ ë²„íŠ¼ í‘œì‹œ
=========================== */
document.addEventListener("click", (e)=>{
    const row = e.target.closest(".data-row");

    document.querySelectorAll(".data-row").forEach(r=>r.classList.remove("show-actions"));

    if(row){
        row.classList.add("show-actions");
    }
});


/* ===========================
   4) í–‰ ì¶”ê°€ / ì‚­ì œ
=========================== */
function addRow(after){
    const newRow = after.cloneNode(true);

    newRow.querySelectorAll(".cell").forEach(c=>{
        if(!c.classList.contains("action-cell")){
            c.innerText = "";
        }
    });

    after.insertAdjacentElement("afterend", newRow);
    refreshAll();
    syncColumnWidths();
}

function deleteRow(row){
    const dataRows = document.querySelectorAll(".data-row");
    if(dataRows.length <= 1){
        alert("ë§ˆì§€ë§‰ í–‰ì€ ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
        return;
    }
    row.remove();
    refreshAll();
    syncColumnWidths();
}

/* ë²„íŠ¼ í´ë¦­ */
document.addEventListener("click", (e)=>{
    if(e.target.classList.contains("add")){
        const row = e.target.closest(".data-row");
        addRow(row);
    }
    if(e.target.classList.contains("del")){
        const row = e.target.closest(".data-row");
        deleteRow(row);
    }
});


/* ===========================
   5) ì •ë ¬ ê¸°ëŠ¥
=========================== */
let sortDir = 1; /* 1 = ì˜¤ë¦„ / -1 = ë‚´ë¦¼ */

document.querySelector(".sort-btn").addEventListener("click", ()=>{
    const rows = [...document.querySelectorAll(".data-row")];
    const table = document.getElementById("table");

    rows.sort((a,b)=>{
        const A = parseInt(a.querySelector(".amount-cell").innerText.replace(/\D/g,"")) || 0;
        const B = parseInt(b.querySelector(".amount-cell").innerText.replace(/\D/g,"")) || 0;
        return (A-B) * sortDir;
    });

    sortDir *= -1; // í´ë¦­í•  ë•Œë§ˆë‹¤ ë°©í–¥ ë°”ë€œ
    rows.forEach(r=>table.appendChild(r));

    refreshAll();
    syncColumnWidths();
});


/* ===========================
   6) ì…ë ¥ ë³€í™” â†’ ìŠ¤íƒ€ì¼ ê°±ì‹ 
=========================== */
document.addEventListener("input", ()=>{
    refreshAll();
    syncColumnWidths();
});


/* ì´ˆê¸° ì‹¤í–‰ */
window.onload = ()=>{
    refreshAll();
    syncColumnWidths();
}

</script>

</body>
</html>
